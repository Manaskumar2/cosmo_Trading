import{r,b as F,h as M,j as e}from"./index-3900eb01.js";import{A as z,S as L}from"./Side-3e953427.js";import{a as x}from"./axios-4a70c6fc.js";import{B as Q}from"./Button-83dfd5e0.js";/* empty css                  *//* empty css             */import{I as O,_ as p}from"./index-4ff9357e.js";import{M as u}from"./Modal-4e23caf1.js";import"./setPrototypeOf-cf8dc84d.js";import"./Button-e11e431e.js";import"./TransitionWrapper-3677d0bf.js";import"./createWithBsPrefix-9178a395.js";import"./index-3edee245.js";const m={position:"top-center",duration:2e3,style:{fontSize:"1rem",background:"#fff",color:"#333"}};function ne(){const[b,v]=r.useState(""),[o,l]=r.useState(1),[j,y]=r.useState(""),[n,g]=r.useState("confirmed"),h=F(M),[d,A]=r.useState(null),[P,S]=r.useState(null),[N,w]=r.useState(""),[i,B]=r.useState(null),[U,I]=r.useState(!1),f=()=>I(!1),$=()=>I(!0),R=t=>{const s=t.target.files[0];S(s)},C=i&&i.data.totalPages,T=async()=>{try{const t=new FormData;t.append("image",P),t.append("upiId",N),t.append("options",b);let s=h._id,a=h.authToken;const c=await x.post(`https://cosmotrade.live/api/admin/uploadQrcode/${s}`,t,{headers:{Authorization:`Bearer ${a}`},"Content-Type":"multipart/form-data"});if(c.status===201)return p.success("Qr code uploaded!",{...m}),w(""),S(null),v(""),c}catch(t){t.response?t.response.data.message:t.message}},_=async t=>{try{let s=h.authToken;const a=await x.get(`https://cosmotrade.live/api/admin/getUserDetails/${t}`,{headers:{Authorization:`Bearer ${s}`}});if(a.status===200)return $(),A(a),a}catch(s){s.response?s.response.data.message:s.message}},k=async()=>{try{let t=h.authToken;const s=await x.get(`https://cosmotrade.live/api/admin/payment-request?status=${n}&page=${o}`,{headers:{Authorization:`Bearer ${t}`}});if(s.status===200)return B(s.data),s}catch(t){const s=t.response?t.response.data.message:t.message;p.error(s||"Something went wrong",{...m})}},D=async(t,s)=>{if(j!=="")try{let a=h.authToken;const c=await x.patch(`https://cosmotrade.live/api/admin/confirm-payment/${t}`,{status:s,approvedBy:j},{headers:{Authorization:`Bearer ${a}`}});if(c.status===200)return p.success(`Recharge request ${s}`,{...m}),f(),y(""),k(),c}catch(a){const c=a.response?a.response.data.message:a.message;p.error(c||"Something went wrong",{...m})}else p.error("Write Your Name First",{...m})};r.useEffect(()=>{k()},[n,o]);const q=()=>{o>1&&l(o-1)},E=()=>{o<C&&l(o+1)};return e.jsxs("div",{children:[e.jsx(z,{}),e.jsxs("div",{className:"flex-div",children:[e.jsx(L,{}),e.jsxs("div",{className:"admin-rightSection",children:[e.jsx(O,{}),e.jsxs("form",{className:"form-rechrge",children:[e.jsx("h3",{className:"text-centre",children:"Submit Qr Code"}),e.jsx("label",{children:"Enter Qr Code Image"}),e.jsx("input",{type:"file",accept:".jpg, .jpeg, .png, .svg",onChange:R}),e.jsx("label",{children:"Enter UPI Id"}),e.jsx("input",{type:"text",value:N,placeholder:"Enter UPI Id",onChange:t=>{w(t.target.value)}}),e.jsxs("div",{className:"sort-dropdown",children:[e.jsx("h5",{children:"Select Method Of UPI:"}),e.jsxs("select",{onChange:t=>v(t.target.value),value:b,children:[e.jsx("option",{value:"",children:"Select an Option"}),e.jsx("option",{value:"Normal",children:"Normal UPI"}),e.jsx("option",{value:"Fast",children:"Fast UPI"})]})]}),e.jsx("button",{onClick:T,children:"Submit"})]}),e.jsxs("div",{className:"row tab-btns",children:[e.jsx("button",{className:n==="confirmed"?"col-4 active-tab-btn-adminPage":"col-4 tab-btn",onClick:()=>{g("confirmed"),l(1)},children:"Approved List"}),e.jsx("button",{className:n==="pending"?"col-4 active-tab-btn-adminPage":"col-4 tab-btn",onClick:()=>{g("pending"),l(1)},children:"Pending List"}),e.jsx("button",{className:n==="cancelled"?"col-4 active-tab-btn-adminPage":"col-4 tab-btn",onClick:()=>{g("cancelled"),l(1)},children:"Reject List"})]}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{className:"table-row",children:[e.jsx("th",{children:"Sl No"}),e.jsx("th",{children:"Transaction Id"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Request Time"}),n!=="pending"&&e.jsx("th",{children:"Action Time"}),e.jsx("th",{children:"Status"}),n!="pending"&&e.jsx("th",{children:"Action Done By"}),e.jsx("th",{children:"Details"})]})}),e.jsx("tbody",{children:i&&i.data.paymentsRequest.map((t,s)=>e.jsxs("tr",{className:"table-row",children:[e.jsx("td",{children:(o-1)*20+s+1}),e.jsx("td",{children:t._id}),e.jsxs("td",{children:[" ",t.amount]}),e.jsx("td",{children:new Date(t.createdAt).toLocaleString()}),n!=="pending"&&e.jsx("td",{children:new Date(t.updatedAt).toLocaleString()}),e.jsx("td",{children:t.status}),n!=="pending"&&e.jsx("td",{children:t.approvedBy}),e.jsxs("td",{children:[" ",e.jsx("button",{type:"button",class:"btn btn-primary",onClick:()=>{_(t.userId)},children:"Details"})," "]}),e.jsxs(u,{show:U,onHide:f,centered:!0,children:[e.jsx(u.Header,{closeButton:!0,children:e.jsx(u.Title,{children:"User Details"})}),e.jsx(u.Body,{className:"userModalBody",children:e.jsxs("div",{children:[e.jsxs("p",{children:["Name: ",d&&d.data.data.userDetails.name]}),e.jsxs("p",{children:["UID: ",d&&d.data.data.userDetails.UID]}),e.jsxs("p",{children:["Phone: ",d&&d.data.data.userDetails.phoneNumber]}),e.jsxs("p",{children:["Upi ReferenceNo: ",t.upiReferenceNo]}),e.jsxs("p",{children:["Upi Id: ",t.upiId]}),n=="pending"&&e.jsxs(e.Fragment,{children:[" ",e.jsxs("div",{children:[" ",e.jsx("input",{type:"text",value:j,onChange:a=>{y(a.target.value)},placeholder:"Enter Name",className:"name-input-admin",style:{width:"14rem"}})," "]}),e.jsx("button",{className:"prime-approve-btn",onClick:()=>{D(t._id,"confirm")},children:"Approve"}),e.jsx("button",{onClick:()=>{D(t._id,"cancel")},className:"prime-reject-btn",children:"Reject"})]})]})}),e.jsx(u.Footer,{children:e.jsx(Q,{variant:"secondary",onClick:f,children:"Close"})})]})]},s))})]}),i&&i.data.paymentsRequest&&i.data.paymentsRequest.length!=0&&e.jsxs("div",{className:"inc-dec-btns",children:[e.jsx("button",{onClick:q,children:"-"}),e.jsxs("div",{children:[o,"/",C]}),e.jsx("button",{onClick:E,children:"+"})]})]})]})]})}export{ne as default,m as toastProps};

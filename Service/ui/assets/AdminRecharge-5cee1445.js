import{r as n,b as z,h as L,j as e}from"./index-555ca70e.js";import{A as Q,S as O}from"./Side-c730da09.js";import{a as j}from"./axios-4a70c6fc.js";import{B as H}from"./Button-178f5130.js";/* empty css                  *//* empty css             */import{I as W,_ as h}from"./index-697d60b7.js";import{M as x}from"./Modal-7d90b00f.js";import"./setPrototypeOf-35303ce5.js";import"./Button-de888c1d.js";import"./TransitionWrapper-84340a80.js";import"./index-1f7d40ad.js";const p={position:"top-center",duration:2e3,style:{fontSize:"1rem",background:"#fff",color:"#333"}};function re(){const[o,A]=n.useState(null),[v,y]=n.useState(""),[i,m]=n.useState(1),[g,S]=n.useState(""),[r,f]=n.useState("confirmed"),u=z(L),[c,P]=n.useState(null),[B,N]=n.useState(null),[I,w]=n.useState(""),[d,U]=n.useState(null),[$,C]=n.useState(!1),b=()=>C(!1),T=()=>C(!0),q=t=>{const s=t.target.files[0];N(s)},k=d&&d.data.totalPages,_=async()=>{try{const t=new FormData;t.append("image",B),t.append("upiId",I),t.append("options",v);let s=u._id,a=u.authToken;const l=await j.post(`https://cosmotrade.live/api/admin/uploadQrcode/${s}`,t,{headers:{Authorization:`Bearer ${a}`},"Content-Type":"multipart/form-data"});if(l.status===201)return h.success("Qr code uploaded!",{...p}),w(""),N(null),y(""),l}catch(t){t.response?t.response.data.message:t.message}},E=async t=>{try{let s=u.authToken;const a=await j.get(`https://cosmotrade.live/api/admin/getUserDetails/${t}`,{headers:{Authorization:`Bearer ${s}`}});if(a.status===200)return T(),P(a),a}catch(s){s.response?s.response.data.message:s.message}},D=async()=>{try{let t=u.authToken;const s=await j.get(`https://cosmotrade.live/api/admin/payment-request?status=${r}&page=${i}`,{headers:{Authorization:`Bearer ${t}`}});if(s.status===200)return U(s.data),s}catch(t){const s=t.response?t.response.data.message:t.message;h.error(s||"Something went wrong",{...p})}},R=async(t,s)=>{if(g!=="")try{let a=u.authToken;const l=await j.patch(`https://cosmotrade.live/api/admin/confirm-payment/${t}`,{status:s,approvedBy:g},{headers:{Authorization:`Bearer ${a}`}});if(l.status===200)return b(),S(""),D(),s==="confirm"&&h.success("Recharge Request Confirmed",{...p}),s==="cancel"&&h.error("Recharge Request Rejected",{...p}),l}catch(a){const l=a.response?a.response.data.message:a.message;h.error(l||"Something went wrong",{...p})}else h.error("Write Your Name First",{...p})};n.useEffect(()=>{D()},[r,i]);const F=()=>{i>1&&m(i-1)},M=()=>{i<k&&m(i+1)};return e.jsxs("div",{children:[e.jsx(Q,{}),e.jsxs("div",{className:"flex-div",children:[e.jsx(O,{}),e.jsxs("div",{className:"admin-rightSection",children:[e.jsx(W,{}),e.jsxs("form",{className:"form-rechrge",children:[e.jsx("h3",{className:"text-centre",children:"Submit Qr Code"}),e.jsx("label",{children:"Enter Qr Code Image"}),e.jsx("input",{type:"file",accept:".jpg, .jpeg, .png, .svg",onChange:q}),e.jsx("label",{children:"Enter UPI Id"}),e.jsx("input",{type:"text",value:I,placeholder:"Enter UPI Id",onChange:t=>{w(t.target.value)}}),e.jsxs("div",{className:"sort-dropdown",children:[e.jsx("h5",{children:"Select Method Of UPI:"}),e.jsxs("select",{onChange:t=>y(t.target.value),value:v,children:[e.jsx("option",{value:"",children:"Select an Option"}),e.jsx("option",{value:"Normal",children:"Normal UPI"}),e.jsx("option",{value:"Fast",children:"Fast UPI"})]})]}),e.jsx("button",{onClick:_,children:"Submit"})]}),e.jsxs("div",{className:"row tab-btns",children:[e.jsx("button",{className:r==="confirmed"?"col-4 active-tab-btn-adminPage":"col-4 tab-btn",onClick:()=>{f("confirmed"),m(1)},children:"Approved List"}),e.jsx("button",{className:r==="pending"?"col-4 active-tab-btn-adminPage":"col-4 tab-btn",onClick:()=>{f("pending"),m(1)},children:"Pending List"}),e.jsx("button",{className:r==="cancelled"?"col-4 active-tab-btn-adminPage":"col-4 tab-btn",onClick:()=>{f("cancelled"),m(1)},children:"Reject List"})]}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{className:"table-row table-heading-admin",children:[e.jsx("th",{children:"Sl No"}),e.jsx("th",{children:"Transaction Id"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Request Time"}),r!=="pending"&&e.jsx("th",{children:"Action Time"}),e.jsx("th",{children:"Status"}),r!="pending"&&e.jsx("th",{children:"Action Done By"}),e.jsx("th",{children:"Details"})]})}),e.jsx("tbody",{children:d&&d.data.paymentsRequest.map((t,s)=>e.jsxs("tr",{className:"table-row",children:[e.jsx("td",{children:(i-1)*20+s+1}),e.jsx("td",{children:t._id}),e.jsxs("td",{children:[" ",t.amount]}),e.jsx("td",{children:new Date(t.createdAt).toLocaleString()}),r!=="pending"&&e.jsx("td",{children:new Date(t.updatedAt).toLocaleString()}),e.jsx("td",{children:t.status}),r!=="pending"&&e.jsx("td",{children:t.approvedBy}),e.jsxs("td",{children:[" ",e.jsx("button",{type:"button",class:"btn btn-primary",onClick:()=>{E(t.userId),A(t)},children:"Details"}),e.jsxs(x,{show:$,onHide:b,centered:!0,children:[e.jsx(x.Header,{closeButton:!0,children:e.jsx(x.Title,{children:"User Details"})}),e.jsx(x.Body,{className:"userModalBody",children:e.jsxs("div",{children:[c&&c.data&&c.data.data&&c.data.data.userDetails&&e.jsxs(e.Fragment,{children:[" ",e.jsxs("p",{children:["Name: ",c.data.data.userDetails.name]}),e.jsxs("p",{children:["UID: ",c.data.data.userDetails.UID]}),e.jsxs("p",{children:["Phone: ",c.data.data.userDetails.phoneNumber]})," "]}),e.jsxs("p",{children:["Upi ReferenceNo: ",o&&o.upiReferenceNo]}),e.jsxs("p",{children:["Upi Id: ",o&&o.upiId]}),r=="pending"&&e.jsxs(e.Fragment,{children:[" ",e.jsxs("div",{children:[" ",e.jsx("input",{type:"text",value:g,onChange:a=>{S(a.target.value)},placeholder:"Enter Name",className:"name-input-admin",style:{width:"14rem"}})," "]}),e.jsx("button",{className:"prime-approve-btn",onClick:()=>{R(o&&o._id,"confirm")},children:"Approve"}),e.jsx("button",{onClick:()=>{R(o&&o._id,"cancel")},className:"prime-reject-btn",children:"Reject"})]})]})}),e.jsx(x.Footer,{children:e.jsx(H,{variant:"secondary",onClick:b,children:"Close"})})]})," "]})]},s))})]}),d&&d.data.paymentsRequest&&d.data.paymentsRequest.length!=0&&e.jsxs("div",{className:"inc-dec-btns",children:[e.jsx("button",{onClick:F,children:"-"}),e.jsxs("div",{children:[i,"/",k]}),e.jsx("button",{onClick:M,children:"+"})]})]})]})]})}export{re as default,p as toastProps};

import{r,d as C,h as R,j as e}from"./index-43c64abb.js";import{A as $,S as D}from"./Side-73b6db07.js";import{a as p}from"./axios-4a70c6fc.js";/* empty css                  */import{A as m}from"./Accordion-c814628c.js";import{I as B,_ as c}from"./index-9d96b1fb.js";import"./TransitionWrapper-39cdea9c.js";import"./react-lifecycles-compat.es-22c986ff.js";const d={position:"top-center",duration:2e3,style:{fontSize:"1rem",background:"#fff",color:"#333"}};function F(){const[u,g]=r.useState(""),[o,h]=r.useState("confirmed"),i=C(R),[l,I]=r.useState(null),[N,x]=r.useState(null),[j,f]=r.useState(""),[y,S]=r.useState(null),k=t=>{const s=t.target.files[0];x(s),console.log(s)},A=async()=>{try{const t=new FormData;t.append("image",N),t.append("upiId",j);let s=i._id,a=i.authToken;const n=await p.post(`https://cosmotrade.live/api/admin/uploadQrcode/${s}`,t,{headers:{Authorization:`Bearer ${a}`},"Content-Type":"multipart/form-data"});if(n.status===201)return c.success("Qr code uploaded!",{...d}),f(""),x(null),n}catch(t){t.response?t.response.data.message:t.message}},w=async t=>{try{let s=i.authToken;const a=await p.get(`https://cosmotrade.live/api/admin/getUserDetails/${t}`,{headers:{Authorization:`Bearer ${s}`}});if(a.status===200)return I(a),a}catch(s){s.response?s.response.data.message:s.message}},b=async()=>{try{let t=i.authToken;const s=await p.get(`https://cosmotrade.live/api/admin/payment-request?status=${o}`,{headers:{Authorization:`Bearer ${t}`}});if(s.status===200)return S(s.data),s}catch(t){const s=t.response?t.response.data.message:t.message;c.error(s||"Something went wrong",{...d})}},v=async(t,s)=>{if(u!=="")try{let a=i.authToken;const n=await p.patch(`https://cosmotrade.live/api/admin/confirm-payment/${t}`,{status:s,approvedBy:u},{headers:{Authorization:`Bearer ${a}`}});if(n.status===200)return c.success("Recharge request confirmed",{...d}),g(""),b(),n}catch(a){const n=a.response?a.response.data.message:a.message;c.error(n||"Something went wrong",{...d})}else c.error("Write Your Name First",{...d})};return r.useEffect(()=>{b()},[o]),e.jsxs("div",{children:[e.jsx($,{}),e.jsxs("div",{className:"flex-div",children:[e.jsx(D,{}),e.jsxs("div",{className:"admin-rightSection",children:[e.jsx(B,{}),e.jsxs("form",{className:"form-rechrge",children:[e.jsx("h3",{className:"text-centre",children:"Submit Qr Code"}),e.jsx("label",{children:"Enter Qr Code Image"}),e.jsx("input",{type:"file",accept:".jpg, .jpeg, .png, .svg",onChange:k}),e.jsx("label",{children:"Enter UPI Id"}),e.jsx("input",{type:"text",value:j,placeholder:"Enter UPI Id",onChange:t=>{f(t.target.value)}}),e.jsx("button",{onClick:A,children:"Submit"})]}),e.jsxs("div",{className:"row tab-btns",children:[e.jsx("button",{className:o==="confirmed"?"col-4 active-tab-btn-adminPage":"col-4 tab-btn",onClick:()=>{h("confirmed")},children:"Approved List"}),e.jsx("button",{className:o==="pending"?"col-4 active-tab-btn-adminPage":"col-4 tab-btn",onClick:()=>{h("pending")},children:"Pending List"}),e.jsx("button",{className:o==="cancelled"?"col-4 active-tab-btn-adminPage":"col-4 tab-btn",onClick:()=>{h("cancelled")},children:"Reject List"})]}),y&&y.map((t,s)=>e.jsx(m,{children:e.jsxs(m.Item,{eventKey:s,children:[e.jsxs(m.Header,{onClick:()=>{w(t.userId)},children:[e.jsxs("p",{style:{marginRight:"3.5rem"},children:["Order: ",t._id]}),e.jsxs("p",{style:{marginRight:"3.5rem"},children:["Amount: ",t.amount]}),e.jsxs("p",{style:{marginRight:"3.5rem"},children:["Status: ",t.status]}),o!=="pending"&&e.jsxs("p",{style:{marginRight:"3.5rem"},children:["Action Done By: ",t.approvedBy]})]}),e.jsxs(m.Body,{children:[e.jsxs("p",{children:["UID: ",l&&l.data.data.userDetails.UID]}),e.jsxs("p",{children:["Phone: ",l&&l.data.data.userDetails.phoneNumber]}),e.jsxs("p",{children:["Upi ReferenceNo: ",t.upiReferenceNo]}),e.jsxs("p",{children:["Upi Id: ",t.upiId]}),t.status!=="confirmed"&&t.status!=="cancelled"&&e.jsxs(e.Fragment,{children:[" ",e.jsxs("div",{children:[" ",e.jsx("input",{type:"text",value:u,onChange:a=>{g(a.target.value)},placeholder:"Enter Name",className:"name-input-admin",style:{width:"14rem"}})," "]}),e.jsx("button",{className:"prime-approve-btn",onClick:()=>{v(t._id,"confirm")},children:"Approve"}),e.jsx("button",{onClick:()=>{v(t._id,"cancel")},className:"prime-reject-btn",children:"Reject"})]})]})]})},s))]})]})]})}export{F as default,d as toastProps};

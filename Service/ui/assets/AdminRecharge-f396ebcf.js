import{r,d as U,h as P,j as e}from"./index-70e3bcd7.js";import{A as R,S as T}from"./Side-3a346d97.js";import{a as p}from"./axios-4a70c6fc.js";import{B as _}from"./Button-76121a0f.js";/* empty css                  *//* empty css             */import{I as E,_ as d}from"./index-4ecd74d8.js";import{M as l}from"./Modal-713a1fa7.js";import"./TransitionWrapper-30149e25.js";import"./Button-45153135.js";import"./createWithBsPrefix-2edff448.js";import"./index-5ace8bc0.js";const h={position:"top-center",duration:2e3,style:{fontSize:"1rem",background:"#fff",color:"#333"}};function O(){const[u,j]=r.useState(""),[n,m]=r.useState("confirmed"),c=U(P),[i,N]=r.useState(null),[k,g]=r.useState(null),[f,b]=r.useState(""),[y,C]=r.useState(null),[D,v]=r.useState(!1),x=()=>v(!1),I=()=>v(!0),A=t=>{const s=t.target.files[0];g(s),console.log(s)},B=async()=>{try{const t=new FormData;t.append("image",k),t.append("upiId",f);let s=c._id,a=c.authToken;const o=await p.post(`https://cosmotrade.live/api/admin/uploadQrcode/${s}`,t,{headers:{Authorization:`Bearer ${a}`},"Content-Type":"multipart/form-data"});if(o.status===201)return d.success("Qr code uploaded!",{...h}),b(""),g(null),o}catch(t){t.response?t.response.data.message:t.message}},$=async t=>{try{let s=c.authToken;const a=await p.get(`https://cosmotrade.live/api/admin/getUserDetails/${t}`,{headers:{Authorization:`Bearer ${s}`}});if(a.status===200)return I(),N(a),a}catch(s){s.response?s.response.data.message:s.message}},S=async()=>{try{let t=c.authToken;const s=await p.get(`https://cosmotrade.live/api/admin/payment-request?status=${n}`,{headers:{Authorization:`Bearer ${t}`}});if(s.status===200)return C(s.data),s}catch(t){const s=t.response?t.response.data.message:t.message;d.error(s||"Something went wrong",{...h})}},w=async(t,s)=>{if(u!=="")try{let a=c.authToken;const o=await p.patch(`https://cosmotrade.live/api/admin/confirm-payment/${t}`,{status:s,approvedBy:u},{headers:{Authorization:`Bearer ${a}`}});if(o.status===200)return d.success("Recharge request confirmed",{...h}),x(),j(""),S(),o}catch(a){const o=a.response?a.response.data.message:a.message;d.error(o||"Something went wrong",{...h})}else d.error("Write Your Name First",{...h})};return r.useEffect(()=>{S()},[n]),e.jsxs("div",{children:[e.jsx(R,{}),e.jsxs("div",{className:"flex-div",children:[e.jsx(T,{}),e.jsxs("div",{className:"admin-rightSection",children:[e.jsx(E,{}),e.jsxs("form",{className:"form-rechrge",children:[e.jsx("h3",{className:"text-centre",children:"Submit Qr Code"}),e.jsx("label",{children:"Enter Qr Code Image"}),e.jsx("input",{type:"file",accept:".jpg, .jpeg, .png, .svg",onChange:A}),e.jsx("label",{children:"Enter UPI Id"}),e.jsx("input",{type:"text",value:f,placeholder:"Enter UPI Id",onChange:t=>{b(t.target.value)}}),e.jsx("button",{onClick:B,children:"Submit"})]}),e.jsxs("div",{className:"row tab-btns",children:[e.jsx("button",{className:n==="confirmed"?"col-4 active-tab-btn-adminPage":"col-4 tab-btn",onClick:()=>{m("confirmed")},children:"Approved List"}),e.jsx("button",{className:n==="pending"?"col-4 active-tab-btn-adminPage":"col-4 tab-btn",onClick:()=>{m("pending")},children:"Pending List"}),e.jsx("button",{className:n==="cancelled"?"col-4 active-tab-btn-adminPage":"col-4 tab-btn",onClick:()=>{m("cancelled")},children:"Reject List"})]}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{className:"table-row",children:[e.jsx("th",{children:"Transaction Id"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Request Time"}),n!=="pending"&&e.jsx("th",{children:"Action Time"}),e.jsx("th",{children:"Status"}),n!="pending"&&e.jsx("th",{children:"Action Done By"}),e.jsx("th",{children:"Details"})]})}),e.jsx("tbody",{children:y&&y.map((t,s)=>e.jsxs("tr",{className:"table-row",children:[e.jsx("td",{children:t._id}),e.jsxs("td",{children:[" ",t.amount]}),e.jsx("td",{children:new Date(t.createdAt).toLocaleString()}),n!=="pending"&&e.jsx("td",{children:new Date(t.updatedAt).toLocaleString()}),e.jsx("td",{children:t.status}),n!=="pending"&&e.jsx("td",{children:t.approvedBy}),e.jsxs("td",{children:[" ",e.jsx("button",{type:"button",class:"btn btn-primary",onClick:()=>{$(t.userId)},children:"Details"})," "]}),e.jsxs(l,{show:D,onHide:x,centered:!0,children:[e.jsx(l.Header,{closeButton:!0,children:e.jsx(l.Title,{children:"User Details"})}),e.jsx(l.Body,{className:"userModalBody",children:e.jsxs("div",{children:[e.jsxs("p",{children:["Name: ",i&&i.data.data.userDetails.name]}),e.jsxs("p",{children:["UID: ",i&&i.data.data.userDetails.UID]}),e.jsxs("p",{children:["Phone: ",i&&i.data.data.userDetails.phoneNumber]}),e.jsxs("p",{children:["Upi ReferenceNo: ",t.upiReferenceNo]}),e.jsxs("p",{children:["Upi Id: ",t.upiId]}),n=="pending"&&e.jsxs(e.Fragment,{children:[" ",e.jsxs("div",{children:[" ",e.jsx("input",{type:"text",value:u,onChange:a=>{j(a.target.value)},placeholder:"Enter Name",className:"name-input-admin",style:{width:"14rem"}})," "]}),e.jsx("button",{className:"prime-approve-btn",onClick:()=>{w(t._id,"confirm")},children:"Approve"}),e.jsx("button",{onClick:()=>{w(t._id,"cancel")},className:"prime-reject-btn",children:"Reject"})]})]})}),e.jsx(l.Footer,{children:e.jsx(_,{variant:"secondary",onClick:x,children:"Close"})})]})]},s))})]})]})]})]})}export{O as default,h as toastProps};
